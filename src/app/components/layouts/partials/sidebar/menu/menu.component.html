<!--begin::sidebar menu-->
<div class="app-sidebar-menu overflow-hidden flex-column-fluid">
  <!--begin::Menu wrapper-->
  <div id="kt_app_sidebar_menu_wrapper" class="app-sidebar-wrapper">
    <!--begin::Scroll wrapper-->
    <div
      id="kt_app_sidebar_menu_scroll"
      class="hover-scroll-y my-5 mx-3"
      data-kt-scroll="true"
      data-kt-scroll-activate="true"
      data-kt-scroll-height="auto"
      data-kt-scroll-dependencies="#kt_app_sidebar_logo, #kt_app_sidebar_footer"
      data-kt-scroll-wrappers="#kt_app_sidebar_menu"
      data-kt-scroll-offset="5px"
      data-kt-scroll-save-state="true"
    >
      <!--begin::Menu-->
      <div
        class="menu menu-column menu-rounded menu-sub-indention fw-semibold"
        id="#kt_app_sidebar_menu"
        data-kt-menu="true"
        data-kt-menu-expand="false"
      >

        <!-- Loop through menu items -->
        <ng-container *ngFor="let menuItem of menuItems">
          
          <!-- Header Item -->
          <div class="menu-item pt-5" *ngIf="menuItem.isHeader">
            <div class="menu-content">
              <span class="menu-heading fw-bold text-uppercase fs-7">{{menuItem.title}}</span>
            </div>
          </div>

          <!-- Accordion Menu Item -->
          <div
            *ngIf="menuItem.isAccordion"
            data-kt-menu-trigger="click"
            class="menu-item menu-accordion"
            [class.here]="menuItem.active"
            [class.show]="menuItem.active"
          >
            <!--begin:Menu link-->
            <span class="menu-link" appHasPermission="{{menuItem.permission}}">
              <span class="menu-icon" *ngIf="menuItem.icon">
                <i [class]="menuItem.icon">
                  <span class="path1"></span>
                  <span class="path2"></span>
                  <span class="path3"></span>
                  <span class="path4"></span>
                </i>
              </span>
              <span class="menu-title">{{menuItem.title}}</span>
              <span class="menu-arrow"></span>
            </span>
            <!--end:Menu link-->
            
            <!--begin:Menu sub-->
            <div class="menu-sub menu-sub-accordion">
              
              <!-- Regular submenu items -->
              <div class="menu-item" *ngFor="let subItem of menuItem.children; let i = index">
                <!-- Show items based on expand/collapse logic -->
                <ng-container *ngIf="!menuItem.hasExpandCollapse || i < (menuItem.children!.length - menuItem.expandCollapseHiddenItems!)">
                  <a
                    class="menu-link"
                    [class.active]="subItem.active"
                    [routerLink]="subItem.route"
                    appHasPermission="{{subItem.permission}}"
                  >
                    <span class="menu-bullet">
                      <span class="bullet bullet-dot"></span>
                    </span>
                    <span class="menu-title">{{subItem.title}}</span>
                  </a>
                </ng-container>
              </div>

              <!-- Collapsible hidden items -->
              <div 
                *ngIf="menuItem.hasExpandCollapse"
                class="menu-inner flex-column collapse"
                [id]="menuItem.expandCollapseId"
              >
                <div class="menu-item" *ngFor="let subItem of menuItem.children; let i = index">
                  <ng-container *ngIf="i >= (menuItem.children!.length - menuItem.expandCollapseHiddenItems!)">
                    <a
                      class="menu-link"
                      [class.active]="subItem.active"
                      [href]="subItem.route"
                    >
                      <span class="menu-bullet">
                        <span class="bullet bullet-dot"></span>
                      </span>
                      <span class="menu-title">{{subItem.title}}</span>
                    </a>
                  </ng-container>
                </div>
              </div>

              <!-- Expand/Collapse button -->
              <div class="menu-item" *ngIf="menuItem.hasExpandCollapse">
                <div class="menu-content">
                  <a
                    class="btn btn-flex btn-color-gray-500 btn-icon-gray-500 d-flex flex-stack fs-base p-0 ms-2 mb-2 toggle collapsible collapsed"
                    data-bs-toggle="collapse"
                    [href]="'#' + menuItem.expandCollapseId"
                    data-kt-toggle-text="Show Less"
                  >
                    <span data-kt-toggle-text-target="true">{{menuItem.expandCollapseText}}</span>
                    <i class="ki-duotone ki-minus-square toggle-on fs-2 me-0 pe-0">
                      <span class="path1"></span>
                      <span class="path2"></span>
                    </i>
                    <i class="ki-duotone ki-plus-square toggle-off fs-2 me-0 pe-0">
                      <span class="path1"></span>
                      <span class="path2"></span>
                      <span class="path3"></span>
                    </i>
                  </a>
                </div>
              </div>

            </div>
            <!--end:Menu sub-->
          </div>

        </ng-container>
        
      </div>
      <!--end::Menu-->
    </div>
    <!--end::Scroll wrapper-->
  </div>
  <!--end::Menu wrapper-->
</div>
<!--end::sidebar menu-->
